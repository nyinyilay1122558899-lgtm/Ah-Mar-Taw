<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rider Wallet & Tasks</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; padding: 15px; margin: 0; }
        .wallet-card { background: linear-gradient(135deg, #4caf50, #2e7d32); padding: 20px; border-radius: 15px; margin-bottom: 20px; text-align: center; }
        .balance { font-size: 30px; font-weight: bold; margin: 10px 0; }
        .task-card { background: #1e1e1e; padding: 15px; border-radius: 15px; margin-bottom: 15px; border-left: 8px solid #4caf50; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; font-weight: bold; margin-top: 10px; cursor: pointer; }
        .btn-withdraw { background: white; color: #2e7d32; }
        .btn-complete { background: #ff9800; color: white; }
    </style>
</head>
<body>

    <div class="wallet-card">
        <p style="margin:0; font-size: 14px;">ğŸ›µ Rider Wallet (Net Earnings)</p>
        <div id="riderBalance" class="balance">0 THB</div>
        <button class="btn btn-withdraw" onclick="alert('á€„á€½á€±á€‘á€¯á€á€ºá€›á€”á€º Admin á€‘á€¶ á€†á€€á€ºá€á€½á€šá€ºá€•á€«')">ğŸ’¸ á€•á€­á€¯á€€á€ºá€†á€¶á€‘á€¯á€á€ºá€™á€Šá€º</button>
    </div>

    <h3>ğŸ“¦ á€œá€€á€ºá€›á€¾á€­á€œá€¯á€•á€ºá€†á€±á€¬á€„á€ºá€›á€™á€Šá€·á€º Tasks</h3>
    <div id="rider-tasks"></div>

    <script>
        const config = { apiKey: "AIzaSyD1KAKqhFVi8VTJRtoolzQKrEmXTnmZUsc", authDomain: "ah-mar-thaw.firebaseapp.com", projectId: "ah-mar-thaw", storageBucket: "ah-mar-thaw.appspot.com", messagingSenderId: "33857508316", appId: "1:33857508316:web:865529f7f9859f7c07b469" };
        firebase.initializeApp(config);
        const db = firebase.firestore();

        // Rider á á€›á€±á€•á€­á€¯á€„á€ºá€„á€½á€±á€€á€­á€¯ á€á€½á€€á€ºá€á€»á€€á€ºá€á€¼á€„á€ºá€¸ (á€•á€­á€¯á€·á€†á€±á€¬á€„á€ºá€ á„á€ á€‘á€²á€™á€¾ áˆá€% á€–á€¼á€…á€ºá€á€±á€¬ áƒá‚ á€˜á€á€ºá€…á€® á€•á€±á€«á€„á€ºá€¸á€•á€±á€¸á€™á€Šá€º)
        db.collection("orders").where("status", "==", "á€•á€­á€¯á€·á€†á€±á€¬á€„á€ºá€™á€¾á€¯ á€•á€¼á€®á€¸á€™á€¼á€±á€¬á€€á€ºá€•á€«á€•á€¼á€®").onSnapshot(snapshot => {
            let totalEarned = 0;
            snapshot.forEach(doc => {
                totalEarned += 32; // á€¥á€•á€™á€¬ - á€á€…á€ºá€á€±á€«á€€á€ºá€œá€»á€¾á€„á€º áƒá‚ á€˜á€á€º (Admin á‚á€% á€–á€¼á€á€ºá€•á€¼á€®á€¸á€á€¬á€¸)
            });
            document.getElementById('riderBalance').innerText = totalEarned + " THB";
        });

        // Tasks á€™á€»á€¬á€¸á€•á€¼á€á€á€¼á€„á€ºá€¸
        db.collection("orders").where("status", "in", ["Rider á€œá€¬á€šá€°á€›á€”á€º á€¡á€á€„á€·á€ºá€–á€¼á€…á€ºá€•á€«á€•á€¼á€®", "Rider á€•á€…á€¹á€…á€Šá€ºá€¸á€•á€­á€¯á€·á€†á€±á€¬á€„á€ºá€”á€±á€•á€«á€•á€¼á€®"]).onSnapshot(snapshot => {
            const list = document.getElementById('rider-tasks');
            list.innerHTML = "";
            snapshot.forEach(doc => {
                const o = doc.data();
                const isDelivering = o.status === "Rider á€•á€…á€¹á€…á€Šá€ºá€¸á€•á€­á€¯á€·á€†á€±á€¬á€„á€ºá€”á€±á€•á€«á€•á€¼á€®";
                list.innerHTML += `
                    <div class="task-card">
                        <p>ğŸ“ <b>á€œá€­á€•á€ºá€…á€¬:</b> ${o.address}</p>
                        <p>ğŸ’° <b>á€›á€›á€¾á€­á€™á€Šá€·á€ºá€„á€½á€±:</b> 32 THB</p>
                        ${isDelivering ? `
                            <input type="file" accept="image/*" id="file-${doc.id}" style="margin-top:10px;">
                            <button class="btn btn-complete" onclick="completeDelivery('${doc.id}')">á€•á€­á€¯á€·á€†á€±á€¬á€„á€ºá€•á€¼á€®á€¸á€€á€¼á€±á€¬á€„á€ºá€¸ á€“á€¬á€á€ºá€•á€¯á€¶á€á€„á€ºá€™á€Šá€º</button>
                        ` : `
                            <button class="btn" style="background:#4caf50; color:white;" onclick="startDelivery('${doc.id}')">á€•á€…á€¹á€…á€Šá€ºá€¸á€…á€á€„á€ºá€•á€­á€¯á€·á€†á€±á€¬á€„á€ºá€™á€Šá€º</button>
                        `}
                    </div>`;
            });
        });

        function startDelivery(id) {
            db.collection("orders").doc(id).update({ status: "Rider á€•á€…á€¹á€…á€Šá€ºá€¸á€•á€­á€¯á€·á€†á€±á€¬á€„á€ºá€”á€±á€•á€«á€•á€¼á€®" });
        }

        function completeDelivery(id) {
            db.collection("orders").doc(id).update({ status: "á€•á€­á€¯á€·á€†á€±á€¬á€„á€ºá€™á€¾á€¯ á€•á€¼á€®á€¸á€™á€¼á€±á€¬á€€á€ºá€•á€«á€•á€¼á€®" })
              .then(() => alert("âœ… á€¡á€œá€¯á€•á€ºá€•á€¼á€®á€¸á€™á€¼á€±á€¬á€€á€ºá€•á€«á€á€Šá€ºá‹ áƒá‚ á€˜á€á€º Wallet á€‘á€² á€›á€±á€¬á€€á€ºá€á€½á€¬á€¸á€•á€«á€•á€¼á€®!"));
        }
    </script>
</body>
</html>










