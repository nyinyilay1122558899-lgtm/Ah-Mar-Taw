<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merchant Registration - Ah Mhar Thaw</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #eceff1; padding: 20px; text-align: center; }
        .reg-box { background: white; padding: 25px; border-radius: 20px; max-width: 450px; margin: auto; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 10px; box-sizing: border-box; }
        #map { height: 200px; border-radius: 10px; margin: 10px 0; border: 2px solid #1976d2; }
        button { width: 100%; padding: 15px; background: #1976d2; color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <div class="reg-box">
        <h2 style="color:#1976d2;">ğŸª á€†á€­á€¯á€„á€ºá€›á€¾á€„á€ºá€™á€¾á€á€ºá€•á€¯á€¶á€á€„á€ºá€›á€”á€º</h2>
        <p style="font-size:13px; color:#666;">á€á€„á€·á€ºá€†á€­á€¯á€„á€ºá€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸á€€á€­á€¯ á€–á€¼á€Šá€·á€ºá€á€½á€„á€ºá€¸á€•á€«</p>
        
        <input type="text" id="storeName" placeholder="á€†á€­á€¯á€„á€ºá€¡á€™á€Šá€º">
        <input type="number" id="storePhone" placeholder="á€†á€€á€ºá€á€½á€šá€ºá€›á€”á€ºá€–á€¯á€”á€ºá€¸">
        <input type="text" id="storeAddress" placeholder="á€†á€­á€¯á€„á€ºá€œá€­á€•á€ºá€…á€¬ (á€¡á€­á€™á€ºá€¡á€™á€¾á€á€º/á€œá€™á€ºá€¸)">
        
        <p style="font-size:12px; color:#d32f2f;">ğŸ“ á€™á€¼á€±á€•á€¯á€¶á€•á€±á€«á€ºá€á€½á€„á€º á€á€„á€·á€ºá€†á€­á€¯á€„á€ºá€á€Šá€ºá€”á€±á€›á€¬á€€á€­á€¯ á€”á€¾á€­á€•á€ºá€•á€«</p>
        <div id="map"></div>
        
        <button onclick="registerStore()">á€†á€­á€¯á€„á€ºá€–á€½á€„á€·á€ºá€™á€Šá€º</button>
    </div>

    <script>
        const config = { apiKey: "AIzaSyD1KAKqhFVi8VTJRtoolzQKrEmXTnmZUsc", authDomain: "ah-mar-thaw.firebaseapp.com", projectId: "ah-mar-thaw", storageBucket: "ah-mar-thaw.appspot.com", messagingSenderId: "33857508316", appId: "1:33857508316:web:865529f7f9859f7c07b469" };
        firebase.initializeApp(config);
        const db = firebase.firestore();

        // Map Setup
        const map = L.map('map').setView([16.8409, 96.1735], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
        let marker;

        map.on('click', e => {
            if (marker) map.removeLayer(marker);
            marker = L.marker(e.latlng).addTo(map);
            window.storeLat = e.latlng.lat;
            window.storeLng = e.latlng.lng;
        });

        function registerStore() {
            const name = document.getElementById('storeName').value;
            const phone = document.getElementById('storePhone').value;
            const address = document.getElementById('storeAddress').value;

            if(!name || !phone || !window.storeLat) return alert("á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€•á€¼á€Šá€·á€ºá€…á€¯á€¶á€…á€½á€¬ á€–á€¼á€Šá€·á€ºá€•á€«");

            db.collection("merchants").add({
                storeName: name,
                phone: phone,
                address: address,
                lat: window.storeLat,
                lng: window.storeLng,
                status: "pending", // á€†á€­á€¯á€„á€ºá€€á€­á€¯ Admin á€€ á€¡á€›á€„á€ºá€¡á€á€Šá€ºá€•á€¼á€¯á€›á€™á€šá€º
                joinDate: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                alert("á€†á€­á€¯á€„á€ºá€™á€¾á€á€ºá€•á€¯á€¶á€á€„á€ºá€á€¼á€„á€ºá€¸ á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á€á€Šá€ºá‹ Admin á á€¡á€á€Šá€ºá€•á€¼á€¯á€á€»á€€á€ºá€€á€­á€¯ á€…á€±á€¬á€„á€·á€ºá€†á€­á€¯á€„á€ºá€¸á€•á€±á€¸á€•á€«!");
                window.location.href = "index.html";
            });
        }
    </script>
</body>
</html>
